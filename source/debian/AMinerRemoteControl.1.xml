<?xml version='1.0' encoding='UTF-8'?>
<!-- This document was created with Syntext Serna Free. --><!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [

<!--

`xsltproc -''-nonet \
          -''-param man.charmap.use.subset "0" \
          -''-param make.year.ranges "1" \
          -''-param make.single.year.ranges "1" \
          /usr/share/xml/docbook/stylesheet/docbook-xsl/manpages/docbook.xsl \
          manpage.xml'

A manual page <package>.<section> will be generated. You may view the
manual page with: nroff -man <package>.<section> | less'. A typical entry
in a Makefile or Makefile.am is:

DB2MAN = /usr/share/sgml/docbook/stylesheet/xsl/docbook-xsl/manpages/docbook.xsl
XP     = xsltproc -''-nonet -''-param man.charmap.use.subset "0"

manpage.1: manpage.xml
        $(XP) $(DB2MAN) $<

The xsltproc binary is found in the xsltproc package. The XSL files are in
docbook-xsl. A description of the parameters you can use can be found in the
docbook-xsl-doc-* packages. Please remember that if you create the nroff
version in one of the debian/rules file targets (such as build), you will need
to include xsltproc and docbook-xsl in your Build-Depends control field.
Alternatively use the xmlto command/package. That will also automatically
pull in xsltproc and docbook-xsl.

Notes for using docbook2x: docbook2x-man does not automatically create the
AUTHOR(S) and COPYRIGHT sections. In this case, please add them manually as
<refsect1> ... </refsect1>.

To disable the automatic creation of the AUTHOR(S) and COPYRIGHT sections
read /usr/share/doc/docbook-xsl/doc/manpages/authors.html. This file can be
found in the docbook-xsl-doc-html package.

Validation can be done using: `xmllint -''-noout -''-valid manpage.xml`

General documentation about man-pages and man-page-formatting:
man(1), man(7), http://www.tldp.org/HOWTO/Man-Page/

-->

  <!-- Fill in your name for FIRSTNAME and SURNAME. -->
  <!ENTITY dhfirstname "Markus">
  <!ENTITY dhsurname   "Wurzenberger">
  <!-- dhusername could also be set to "&dhfirstname; &dhsurname;". -->
  <!ENTITY dhusername  "Markus Wurzenberger">
  <!ENTITY dhemail     "markus.wurzenberger@ait.ac.at">
  <!-- SECTION should be 1-8, maybe w/ subsection other parameters are
       allowed: see man(7), man(1) and
       http://www.tldp.org/HOWTO/Man-Page/q2.html. -->
  <!ENTITY dhsection   "1">
  <!-- TITLE should be something like "User commands" or similar (see
       http://www.tldp.org/HOWTO/Man-Page/q2.html). -->
  <!ENTITY dhtitle     "logdata-anomaly-miner User Manual">
  <!ENTITY dhucpackage "LOGDATA-ANOMALY-MINER">
  <!ENTITY dhpackage   "logdata-anomaly-miner">
]>
<refentry>
  <refentryinfo>
    <title>&dhtitle;</title>
    <productname>&dhpackage;</productname>
    <authorgroup>
      <author>
        <firstname>&dhfirstname;</firstname>
        <surname>&dhsurname;</surname>
        <contrib>Wrote this manpage for the Debian system.</contrib>
        <address>
          <email>&dhemail;</email>
        </address>
      </author>
    </authorgroup>
    <copyright>
      <year>2016</year>
      <holder>&dhusername;</holder>
    </copyright>
    <legalnotice>
      <para>This manual page was written for the Debian system
        (and may be used by others).</para>
      <para>Permission is granted to copy, distribute and/or modify this
        document under the terms of the GNU General Public License,
        Version 3.</para>
      <para>On Debian systems, the complete text of the GNU General Public
        License can be found in
        <filename>/usr/share/common-licenses/GPL</filename>.</para>
    </legalnotice>
  </refentryinfo>
  <refmeta>
    <refentrytitle>AMINERREMOTECONTROL</refentrytitle>
    <manvolnum>&dhsection;</manvolnum>
  </refmeta>
  <refnamediv>
    <refname>AMinerRemoteControl</refname>
    <refpurpose>lightweight tool for log checking, log analysis </refpurpose>
  </refnamediv>
  <refsynopsisdiv>
    <cmdsynopsis>
      <command>AMinerRemoteControl</command>
<!-- These are several examples, how syntaxes could look -->      <arg choice="plain">
        <option>--ControlSocket <replaceable>socket</replaceable></option>
      </arg>
      <arg choice="opt">
        <option>--Exec <replaceable>command</replaceable></option>
      </arg>
      <arg choice="opt">
        <option>--ExecFile <replaceable>file</replaceable></option>
      </arg>
      <arg choice="opt">
        <option>--Data <replaceable>data</replaceable></option>
      </arg>
      <arg choice="opt">
        <option>--StringResponse</option>
      </arg>
    </cmdsynopsis>
  </refsynopsisdiv>
  <refsect1 id="description">
    <title>DESCRIPTION</title>
    <para>This manual page documents briefly the
      <command>AMinerRemoteControl</command> command. The command
      executes arbitrary remote control commands in a running
      AMiner child process. As child process is usually running
      with lowered privileges or SELinux/AppArmor confinement,
      you may observe unexpected results when accessing resources
      outside the child process, e.g. files. For more details
      see also packaged documentation at
      /usr/share/doc/logdata-anomaly-miner.</para>
    <refsect2 id="example_usecases">
      <title>Example usecases:</title>
      <variablelist>
        <varlistentry>
          <term>
            <option>Print a property of the running AMinerConfig:</option>
          </term>
          <listitem>
            <para>/usr/bin/AMinerRemoteControl --Data &apos;[&quot;LogResourceList&quot;]&apos; --Exec &apos;
            printConfigProperty(analysisContext,  &quot;%s&quot; % remoteControlData[0])&apos;</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <option>Print the complete AMinerConfig:</option>
          </term>
          <listitem>
            <para>/usr/bin/AMinerRemoteControl --Exec &apos;printCurrentConfig(analysisContext)&apos;</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </refsect2>
  </refsect1>
  <refsect1 id="options">
    <title>OPTIONS</title>
    <para>
      with long options starting with two dashes (&apos;-&apos;).  A summary of
      options is included below.  For a complete description, see the
      <citerefentry>
        <refentrytitle>info</refentrytitle>
        <manvolnum>1</manvolnum>
      </citerefentry> files.</para>
    <variablelist>
<!-- Use the variablelist.term.separator and the
           variablelist.term.break.after parameters to
           control the term elements. -->      <varlistentry>
        <term>
          <option>--ControlSocket <replaceable>socket</replaceable></option>
        </term>
        <listitem>
          <para>Specify the Unix domain remote control socket
          path, otherwise /var/run/aminer-remote.socket is used.
          The socket is opened by AMiner when &apos;RemoteControlSocket&apos;
          feature is enabled in configuration. As the socket is
          of SOCK_STREAM type, it may also be forwarded via any
          other stream forwarders, e.g. socat (see UNIX-CONNECT
          and UNIX-LISTEN) and SSH (see LocalForward, DynamicForward).
          Access control is only done by file system permissions
          (DAC) of the socket, so make sure not to widen the access
          on error.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>--Exec <replaceable>command</replaceable></option>
        </term>
        <listitem>
          <para>For each --Exec option, the next argument is sent
          in a separate remote execution request using additional
          execution data (see --Data). The command is executed in
          a separate execution namespace with only some
          variables added to the local namespace, e.g. execution
          data is available as &apos;remoteControlData&apos;. When setting
          the local variable &apos;remoteControlResponse&apos; within the
          executed command, the object is serialized using json and
          sent back in the response.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>--ExecFile <replaceable>file</replaceable></option>
        </term>
        <listitem>
          <para>For each --ExecFile option, the named file is
          loaded and content submitted in the very same way as
          if --Exec parameter with content as string would have
          been used.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>--Data <replaceable>data</replaceable></option>
        </term>
        <listitem>
          <para>This parameter defines a json string defining
          Python objects, that will be sent with all subsequent
          --Exec operations until changed again using another
          --Data option. Take into account, that there are size
          limits for the request, very large data objects may
          exceed those limits. The execution context will expose
          the data as variable &apos;remoteControlData&apos;.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>--StringResponse</option>
        </term>
        <listitem>
          <para>When set, AMinerRemoteControl will not pass the
          result to repr. The returned object is just converted
          to a plain string via str(object) and the result is
          printed to avoid escaping of quotation marks, newlines,
          .... WARNING: This might be insecure: without escaping
          the printed data may contain terminal control sequences
          to exploit vulnerabilities or misconfiguration of your
          terminal to execute code with privileges of terminal
          or the process calling AMinerRemoteControl (usually
          root).</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <refsect2 id="command">
      <title>Commands</title>
      <variablelist>
        <varlistentry>
          <term>
            <option>
              <replaceable>changeConfigProperty(analysisContext,propertyName,value)</replaceable>
            </option>
          </term>
          <listitem>
            <para>This method allows you to change properties from the 
            AMinerConfig at runtime. For every property to be changed 
            this method must be used. The method prints 
            &quot;<replaceable>propertyName</replaceable> changed to 
            <replaceable>value</replaceable> successfully.&quot; if the 
            changes were successful and an individual message if the changes failed.</para>
            <para>Read more about which properties can be changed in the <option>Valid Property Names </option>section.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <option>
              <replaceable>changeAttributeOfRegisteredAnalysisComponent(analysisContext,componentName,attribute,value)</replaceable>
            </option>
          </term>
          <listitem>
            <para>This method allows you to change attributes from components of the 
            AMinerConfig at runtime. For every attribute to be changed this method 
            must be used. The method prints &quot;<replaceable>componentName.attribute </replaceable> changed to <replaceable>value</replaceable> successfully.
            &quot; if the changes were successful and an individual message if the changes failed.
            The type of the new <replaceable>value</replaceable> must be the same like the
            old value of the <replaceable>componentName.attribute</replaceable></para>
            <para><replaceable>example</replaceable>: AMinerRemoteControl --Exec 
            &quot;changeAttributeOfRegisteredAnalysisComponent(analysisContext, 
            &apos;NewMatchPath&apos;, &apos;autoIncludeFlag&apos;, False)&quot;</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <option>
              <replaceable>renameRegisteredAnalysisComponent(analysisContext,oldComponentName,newComponentName)</replaceable>
            </option>
          </term>
          <listitem>
            <para>Renames the component from the <replaceable>oldComponentName</replaceable>
            to <replaceable>newComponentName</replaceable>. Therefore the component with the
            <replaceable>oldComponentName</replaceable> is deleted from the registered components
            and registered with the <replaceable>newComponentName</replaceable>.</para>
            <para><replaceable>example</replaceable>: AMinerRemoteControl --Exec 
           &quot;renameRegisteredAnalysisComponent(analysisContext,&apos;NewMatchPath&apos;,&apos;NewMatchPathDetector&apos;)&quot;</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <option>
              <replaceable>printConfigProperty(analysisContext,propertyName)</replaceable>
            </option>
          </term>
          <listitem>
            <para>Prints the property with the <replaceable>propertyName</replaceable> 
            from the current AMinerConfig.</para>
            <para><replaceable>example</replaceable>: AMinerRemoteControl --Exec 
            &quot;printConfigProperty(analysisContext,&apos;NewMatchPath&apos;)&quot;</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <option>
              <replaceable>printAttributeOfRegisteredAnalysisComponent(analysisContext,componentName, attribute)</replaceable>
            </option>
          </term>
          <listitem>
            <para>Prints the <replaceable>attribute</replaceable> of the component 
            with the <replaceable>componentName</replaceable>.</para>
            <para><replaceable>example</replaceable>: AMinerRemoteControl --Exec 
            &quot;printAttributeOfRegisteredAnalysisComponent(analysisContext,&apos;NewMatchPath&apos;, &apos;autoIncludeFlag&apos;)&quot;</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <option>
              <replaceable>printCurrentConfig(analysisContext)</replaceable>
            </option>
          </term>
          <listitem>
            <para>Prints the current AMinerConfig. It is strongly recommended to use the 
            <option>--StringResponse</option> parameter for better readability.</para>
            <para><replaceable>example</replaceable>: AMinerRemoteControl --Exec 
            &quot;printCurrentConfig(analysisContext)&quot; --StringResponse</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <option>
              <replaceable>saveCurrentConfig(analysisContext,destinationFile)</replaceable>
            </option>
          </term>
          <listitem>
            <para>Saves the current AMinerConfig into <replaceable>destinationFile</replaceable>.
            <replaceable>destinationFile</replaceable> must have write permissions by the 
             AMinerRemoteControl process or it returns an <option>PermissionError</option>.</para>
            <para><replaceable>example</replaceable>: AMinerRemoteControl --Exec 
            &quot;saveCurrentConfig(analysisContext,&apos;/tmp/config.py&apos;)&quot;</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <option>
              <replaceable>whitelistEvent(analysisContext,componentName,eventData,whitelistingData=None)</replaceable>
            </option>
          </term>
          <listitem>
            <para>Whitelists a path from <replaceable>eventData</replaceable> with the
             whitelistEvent-method from the corresponding class of the component with the
            <replaceable>componentName</replaceable>. Only the following classes
             support whitelisting: <replaceable>EnhancedNewMatchPathValueComboDetector
             </replaceable>, <replaceable>MissingMatchPathValueDetector</replaceable>, 
             <replaceable>NewMatchPathDetector</replaceable> and 
             <replaceable>NewMatchPathValueComboDetector</replaceable>.
             For most of the components no <replaceable>whitelistingData</replaceable> 
             is needed and the <replaceable>eventData</replaceable> is a path. The 
            <replaceable>NewMatchPathDetector</replaceable> supports a list of multiple 
             pathes. The <replaceable>MissingMatchPathValueComboDetector</replaceable> 
             needs an integer as <replaceable>whitelistingData</replaceable>. A positive value 
             sets the interval in seconds to the value. -1 sets the interval to the default value of 3600. 
             A negative value removes the missingMatchPath.
             Please read the examples of this method to use the correct parameters.</para>
            <para><replaceable>example</replaceable>: AMinerRemoteControl --Exec 
            &quot;whitelistEvent(analysisContext,&apos;EnhancedNewMatchPathValueComboDetector&apos;,&apos;new/path&apos;)&quot;</para>
            <para><replaceable>example</replaceable>: AMinerRemoteControl --Exec 
            &quot;whitelistEvent(analysisContext,&apos;MissingMatchPathValueDetector&apos;,&apos;new/path&apos;,-11)&quot;</para>
            <para><replaceable>example</replaceable>: AMinerRemoteControl --Exec 
            &quot;whitelistEvent(analysisContext,&apos;NewMatchPathDetector&apos;,[&apos;new/path&apos;])&quot;</para>
            <para><replaceable>example</replaceable>: AMinerRemoteControl --Exec 
            &quot;whitelistEvent(analysisContext,&apos;NewMatchPathValueComboDetector&apos;,&apos;new/path&apos;)&quot;</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <option>
              <replaceable>TO BE CONTINUED..: AecidCli methods</replaceable>
            </option>
          </term>
          <listitem>
            <para>These methods will be implemented in future..</para>
            <para><replaceable>example</replaceable>: </para>
          </listitem>
        </varlistentry>
      </variablelist>
    </refsect2>
    <refsect2 id="PropertyNames">
      <title>Valid Property Names</title>
      <variablelist>
        <varlistentry>
          <term>
            <replaceable>TODO: MailAlerting.TargetAddress</replaceable>
          </term>
          <listitem>
            <para><replaceable>Value</replaceable>: &apos;E-Mail Address&apos;</para>
            <para><replaceable>Example</replaceable>: AMinerRemoteControl --Exec 
            &quot;changeConfigProperty(analysisContext, &apos;MailAlerting.TargetAddress&apos;,
            &apos;root@localhost&apos;)&quot;</para>
            <para>Define a target e-mail address to send alerts to. When undefined, no e-mail notification hooks are added.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <replaceable>TODO: MailAlerting.FromAddress</replaceable>
          </term>
          <listitem>
            <para><replaceable>Value</replaceable>: &apos;E-Mail Address&apos;</para>
            <para><replaceable>Example</replaceable>: AMinerRemoteControl --Exec 
            &quot;changeConfigProperty(analysisContext, &apos;MailAlerting.FromAddress&apos;, 
            &apos;root@localhost&apos;)&quot;</para>
            <para>Sender address of e-mail alerts. When undefined, &quot;sendmail&quot; 
            implementation on host will decide, which sender address should be used.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <replaceable>TODO: MailAlerting.SubjectPrefix</replaceable>
          </term>
          <listitem>
            <para><replaceable>Value</replaceable>: &apos;String&apos;</para>
            <para><replaceable>Example</replaceable>: AMinerRemoteControl --Exec 
            &quot;changeConfigProperty(analysisContext, &apos;MailAlerting.SubjectPrefix&apos;, 
            &apos;AMiner Alerts:&apos;)&quot;</para>
            <para>Define, which text should be prepended to the standard aminer subject. 
            Defaults to &quot;AMiner Alerts:&quot;</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <replaceable>TODO: MailAlerting.EventCollectTime</replaceable>
          </term>
          <listitem>
            <para><replaceable>Value</replaceable>: Seconds (Integer)</para>
            <para><replaceable>Example</replaceable>: AMinerRemoteControl --Exec 
            &quot;changeConfigProperty(analysisContext, &apos;MailAlerting.EventCollectTime&apos;, 10)&quot;</para>
            <para>Define how many seconds to wait after a first event triggered the alerting procedure 
            before really sending out the e-mail. In that timespan, events are collected and will be sent 
            all using a single e-mail. Defaults to 10 seconds.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <replaceable>TODO: MailAlerting.MinAlertGap</replaceable>
          </term>
          <listitem>
            <para><replaceable>Value</replaceable>: Seconds (Integer)</para>
            <para><replaceable>Example</replaceable>: AMinerRemoteControl --Exec 
            &quot;changeConfigProperty(analysisContext, &apos;MailAlerting.MinAlertGap&apos;, 600)&quot;</para>
            <para>Define the minimum time between two alert e-mails in seconds to avoid spamming. 
             All events during this timespan are collected and sent out with the next report. Defaults to 600 seconds.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <replaceable>TODO: MailAlerting.MaxAlertGap</replaceable>
          </term>
          <listitem>
            <para><replaceable>Value</replaceable>: Seconds (Integer)</para>
            <para><replaceable>Example</replaceable>: AMinerRemoteControl --Exec 
            &quot;changeConfigProperty(analysisContext, &apos;MailAlerting.MaxAlertGap&apos;, 1000)&quot;</para>
            <para>Define the maximum time between two alert e-mails in seconds. 
            When undefined this defaults to &quot;MailAlerting.MinAlertGap&quot;. 
            Otherwise this will activate an exponential backoff to reduce messages 
            during permanent error states by increasing the alert gap by 50% when more 
            alert-worthy events were recorded while the previous gap time was not yet elapsed.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <replaceable>TODO: MailAlerting.MaxEventsPerMessage</replaceable>
          </term>
          <listitem>
            <para><replaceable>Value</replaceable>: Number of messages (Integer)</para>
            <para><replaceable>Example</replaceable>: AMinerRemoteControl --Exec 
            &quot;changeConfigProperty(analysisContext, &apos;MailAlerting.MaxEventsPerMessage&apos;, 1000)&quot;</para>
            <para>Define how many events should be included in one alert mail at most. This defaults to 1000.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <replaceable>LogPrefix</replaceable>
          </term>
          <listitem>
            <para><replaceable>Value</replaceable>: &apos;String&apos;</para>
            <para><replaceable>Example</replaceable>: AMinerRemoteControl --Exec 
            &quot;changeConfigProperty(analysisContext, &apos;LogPrefix&apos;, &apos;
            Original log line: &apos;)&quot;</para>
            <para>Most analysis components implement the outputLogLine-property, which is True by default. 
             Define a prefix to the original captured log lines. This defaults to &apos;&apos;</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <replaceable>Resources.MaxMemoryUsage</replaceable>
          </term>
          <listitem>
            <para><replaceable>Value</replaceable>: &apos;Allowed RAM usage in Megabytes 
            (Integer: 32-maxSystemRAM)&apos;</para>
            <para><replaceable>Example</replaceable>: AMinerRemoteControl --Exec 
            &quot;changeConfigProperty(analysisContext, &apos;Resources.MaxMemoryUsage&apos;, -1)&quot;</para>
            <para>This property limits the maximal possible RAM in MB which the AMiner process can use. 
            Be careful at choosing the value, as a shortage of memory causes a MemoryError. This defaults to 
           -1, which means that there is no limit.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <replaceable>Resources.MaxCpuPercentUsage</replaceable>
          </term>
          <listitem>
            <para><replaceable>Value</replaceable>: Integer: 1-100</para>
            <para><replaceable>Example</replaceable>: AMinerRemoteControl --Exec 
            &quot;changeConfigProperty(analysisContext, &apos;Resources.MaxCpuPercentUsage&apos;, 30)</para>
            <para>By limiting the AMiner process to a fraction of possible CPU usage the system 
            can not longer be overloaded by it. The percentages can only be full numbers and must 
            be between 1 and 100.</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </refsect2>
  </refsect1>
  <refsect1 id="files">
    <title>FILES</title>
    <variablelist>
      <varlistentry>
        <term>
          <filename>/var/run/aminer-remote.socket</filename>
        </term>
        <listitem>
          <para>This is the default remote control socket used
          when not changed using the --ControlSocket option.</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </refsect1>
  <refsect1 id="bugs">
    <title>BUGS</title>
    <para>
      Report bugs via your distribution&apos;s bug tracking system.
      For bugs in the the software trunk, report via
      at <ulink url="https://bugs.launchpad.net/logdata-anomaly-miner/+filebug"/>.</para>
  </refsect1>
  <refsect1 id="see_also">
    <title>SEE ALSO</title>
<!-- In alpabetical order. -->    <para>
      <citerefentry>
        <refentrytitle>AMiner</refentrytitle>
        <manvolnum>1</manvolnum>
      </citerefentry>
    </para>
  </refsect1>
</refentry>
